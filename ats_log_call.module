<?php



/**
 * Implements hook_menu().
 */
function ats_log_call_menu() {
  $items = array();
  $items['ats-log-call'] = array(
    'title' => 'Статистика телефонных звонков',
    'description' => 'Позволяет просматрифать статистику звонков офисной АТС ГП "Укршахтгидрозащита".',
    'page callback' => 'ats_log_call_list',
    'access arguments' => TRUE,
    'weight' => -10,
  );

  return $items;
}



function ats_log_call_list() {
  $output = '';
  
  $select = db_select('ats_log_call','a')
  ->fields('a')
  ->orderBy('id', 'DESC')
  ->extend('PagerDefault')
  ->limit(30);
  $result = $select->execute();
  $rows = array();
  $i = 0;
  while ($row = $result->fetchAssoc()) {
    $rows[] = $row;
//    dpm($row,'Row ' . $i);
    $i++;
  }
//  dpm($rows,'Rows');
  $output .= theme('table', array( 'rows' => $rows));

  return $output;
}